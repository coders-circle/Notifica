{% extends "base.html" %}
{% load staticfiles %}
{% load customtags %}
{% load classroom_tags %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'css/routine.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/selectize.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/selectize.bootstrap3.css' %}">
<script src="{% static 'js/routine.js' %}"></script>
<script src="{% static 'js/selectize.js' %}"></script>
<script>
    var idCount=1111111;
    function getNotificaID(){
        return 'x'+(idCount++).toString();
    }
    var routine = [
        {% for day, periods in routine.items %}[
            {% for p in periods %} {
                {% with subject=p.subject|linked_object %}
                subject:{
                    name:"{% if subject %} {{ subject.name }} {% else %} {{ p.subject }} {% endif %}",
                    {% if subject %}
                    notifica_id:"{{ subject.notifica_id }}"
                    {% else %}
                    notifica_id:getNotificaID()
                    {% endif %}
                },
                {% endwith %}
                teachers:[
                    {% for t in p.teachers|json_decode %} {
                        {% with teacher=t|linked_object %}
                        name:"{% if teacher %}{{teacher.user.first_name}}{% else %}{{ t }}{% endif %}"
                        {% endwith %}
                    },
                    {% endfor %}
                ],
                remark:"{{p.remarks}}",
                start_time:{{p.start_time}},
                end_time:{{p.end_time}}
            },
            {% endfor %}
        ],
        {% endfor %}
    ];

    console.log(routine[0][0].subject);
</script>

{% endblock %}

{% block body %}
<div class="block" id="title-block">
    <a href="{% url 'user' %}">News Feeds</a>
    <h1>Notifica</h1>
    <p>
        Weekly Routine
    </p>
</div>
<div id="add-subject-dialog" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Period</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 form-group">
                        <input id="start-time" class="input-start-time form-control" type="text" placeholder="Start time">
                    </div>
                    <div class="col-sm-6 form-group">
                        <input id="end-time" class="input-end-time form-control" type="text" placeholder="End time">
                    </div>
                </div>
                <div class="form-group" id="subject-input">
                    <input id="subject" class="input-subject form-control" type="text" placeholder="Subject">
                </div>
                <div class="form-group" id="teachers-input">
                    <input class="input-teachers form-control" type="text" placeholder="Teachers">
                </div>
                <div class="form-group">
                    <input class="input-remarks form-control" type="text" placeholder="Remarks">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-dlg-ok"><i class="fa fa-check"></i> Ok</button>
                <button class="btn-dlg-cancel"><i class="fa fa-times"></i> Cancel</button>
            </div>
        </div>
    </div>
</div>
<div class="template-period hidden">
    <p class="subject"></p>
    <p class="teachers"></p>
    <p class="remarks"></p>
</div>
<div class="backdrop"></div>
<div class="add-subject-dialog">
    <div class="dialog-header">
        <h3>Add Period</h3>
    </div>
    <div class="dialog-content">
        <input class="input-subject" type="text" placeholder="Subject">
        <input class="input-teachers" type="text" placeholder="Teachers">
        <input class="input-remarks" type="text" placeholder="Remarks">
    </div>
    <div class="dialog-footer">
        <button class="btn-dlg-ok"><i class="fa fa-check"></i> Ok</button>
        <button class="btn-dlg-cancel"><i class="fa fa-times"></i> Cancel</button>
    </div>
</div>
<div class="block" id="routine-block">
    <div class="row row-heading">
        <div class="col-md-1">
            Day / Time
        </div>
        <div class="col-md-11">
        </div>
    </div>
    {% for day in days_short %}
    <div class="row">
        <div class="col-md-1">
            <p class="day-name">{{ day }}</p>
            <button class="btn-add-period"><i class="fa fa-plus"></i> Period</button>
        </div>
        <div class="col-md-11">
            <div class="periods">
            </div>
        </div>
    </div>
    {% endfor %}
{% endblock %}
