{% extends "base.html" %}
{% load staticfiles %}
{% load customtags %}
{% load classroom_tags %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'css/routine.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/selectize.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'css/selectize.bootstrap3.css' %}">
<script src="{% static 'js/routine.js' %}"></script>
<script src="{% static 'js/selectize.js' %}"></script>
<script>
    var periodsCount=0;
    var routine = [];
    var routine_all = [
        {% for day, periods in routine.items %}[
            {% for p in periods %} {
                id: periodsCount++,
                subject:{
                    name: "{{ p.subject|safe }}",
                    id: {{ p.subject.id }}
                },
                teachers:[
                    {% for t in p.teachers.all %} {
                        name: "{{ t }}",
                        id: {{ t.id }}
                    },
                    {% endfor %}
                ],
                remarks:"{{p.remarks}}",
                start_time:{{p.start_time}},
                end_time:{{p.end_time}},
                groups:[
                    {% for group in p.groups.all %}{
                        name: "{{group}}",
                        id: "{{group.id}}"
                    },
                    {% endfor %}
                ]
            },
            {% endfor %}
        ],
        {% endfor %}
    ];
    var group_list = [
    {% for group in groups.all %}{
            id: "{{ group.id }}",
            name: "{{ group }}"
        },
    {% endfor %}
    ];
    function saveRoutine() {
        document.forms['routineform'].routine.value = JSON.stringify(routine);
        document.forms['routineform'].submit();
    }
</script>

{% endblock %}

{% block body %}
<div class="block" id="title-block">
    <a href="{% url 'posts:feed' %}">News Feeds</a>
    <h1>notifica</h1>
    <p>
        Weekly Routine
    </p>
    {% if groups.all %}
    <div id="group-select">
        Group:
        <select>
            {% for group in groups.all %}
            <option value="{{ group.id }}">{{group}}</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
</div>
<div id="add-subject-dialog" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Period</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 form-group">
                        <input id="start-time" class="input-start-time form-control" type="text" placeholder="Start time">
                    </div>
                    <div class="col-sm-6 form-group">
                        <input id="end-time" class="input-end-time form-control" type="text" placeholder="End time">
                    </div>
                </div>
                <div class="form-group" id="subject-input">
                    <input id="subject" class="input-subject form-control" type="text" placeholder="Subject">
                </div>
                <div class="form-group" id="teachers-input">
                    <input class="input-teachers form-control" type="text" placeholder="Teachers">
                </div>
                <div class="form-group">
                    <input class="input-remarks form-control" type="text" placeholder="Remarks">
                </div>
                {% if groups.all %}
                <label>Groups</label>
                <div class="group-selection">
                    {% for group in groups.all %}
                    <label class="checkbox-inline"><input id="{{ group.id }}" class="input-group-select" type="checkbox" checked>{{ group }}</label>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            <div class="modal-footer">
                <button class="btn-dlg-ok"><i class="fa fa-check"></i> Ok</button>
                <button class="btn-dlg-cancel"><i class="fa fa-times"></i> Cancel</button>
            </div>
        </div>
    </div>
</div>
<div class="template-period hidden">
    <p class="subject"></p>
    <p class="teachers"></p>
    <p class="remarks"></p>
</div>

<div class="block" id="routine-block">
    <div class="row row-heading">
        <div class="col-md-1">
            Day / Time
        </div>
        <div class="col-md-11" id="time-line">
        </div>
    </div>
    {% for day in days_short %}
    <div class="row row-day row-day-{{ forloop.counter0 }}" data-index-day="{{ forloop.counter0 }}" >
        <div class="col-md-1 col-days">
            <p class="day-name">{{ day }}</p>
            <button class="btn-add-period" ><i class="fa fa-plus"></i> Period</button>
        </div>
        <div class="col-md-11 col-periods">
        </div>
    </div>
    {% endfor %}
</div>

<form name="routineform" method="post">
    {% csrf_token %}
    <input name="routine" value="" type="hidden">
</form>

<button onclick="saveRoutine()">Save Changes</button>
Is Admin: {% if is_admin %} true {% else %} false {% endif %}
{% endblock %}
